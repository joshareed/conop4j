apply plugin: 'java'
apply plugin: 'eclipse'

sourceCompatibility = 1.5
targetCompatibility = 1.5
version = '0.7.0'
group = 'org.andrill.conop'

manifest.mainAttributes(
	'Implementation-Title': 'CONOP Tools',
	'Implementation-Version': version,
	'Main-Class': 'org.andrill.conop.ui.CONOPTools'
)

repositories {
	mavenCentral()
}

dependencies {
	compile 'com.google.guava:guava:r08'
	compile 'org.apache.poi:poi:3.7'
	compile 'org.apache.poi:poi-ooxml:3.7'
	compile 'net.sf.jopt-simple:jopt-simple:3.2'
	compile 'com.miglayout:miglayout:3.7.4:swing@jar'
	testCompile 'junit:junit:4.8.2'
}

task release(dependsOn: configurations.default.buildArtifacts) << {
	def dest = file("$buildDir/fatjar")
	dest.mkdirs()

	// expand all our dependencies
	configurations.compile.each { jar ->
		ant.unzip(src: jar, dest: dest, overwrite: true)
	}

	// expand our code
	configurations.default.allArtifactFiles.each { jar ->
		ant.unzip(src: jar, dest: dest, overwrite: true)
	}

	// create our fatjar
	mkdir("$buildDir/release")
	ant.zip(destfile: "$buildDir/release/conop-tools-${version}.jar", basedir: dest)
}

task wrapper(type: Wrapper) {
	gradleVersion = '0.9'
	jarFile = 'wrapper/wrapper.jar'
}